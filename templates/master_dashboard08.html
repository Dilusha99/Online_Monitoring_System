<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="static\images\logo.svg" sizes="32x32">
    <title>Master Dashboard</title>
    <style>
        /* ===== GLASSMORPHISM MASTER DASHBOARD - DARK THEME ===== */
                
                * {
                    margin: 0;
                    padding: 0;
                    box-sizing: border-box;
                }

                body {
                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                    min-height: 100vh;
                    overflow-x: hidden;
                    position: relative;
                    background: #0a0a0f;
                }

                /* Animated Gradient Background - Darker tones */
                body::before {
                    content: '';
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: linear-gradient(135deg, 
                        #1a1a2e 0%, 
                        #16213e 25%, 
                        #0f3460 50%, 
                        #1a1a2e 75%, 
                        #0d0d1a 100%);
                    background-size: 400% 400%;
                    animation: gradientShift 15s ease infinite;
                    z-index: -2;
                }

                /* Floating Particles Background */
                body::after {
                    content: '';
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background-image: 
                        radial-gradient(2px 2px at 20% 30%, rgba(255, 255, 255, 0.3), transparent),
                        radial-gradient(2px 2px at 60% 70%, rgba(255, 255, 255, 0.3), transparent),
                        radial-gradient(1px 1px at 50% 50%, rgba(255, 255, 255, 0.3), transparent),
                        radial-gradient(1px 1px at 80% 10%, rgba(255, 255, 255, 0.3), transparent),
                        radial-gradient(2px 2px at 90% 60%, rgba(255, 255, 255, 0.3), transparent),
                        radial-gradient(1px 1px at 33% 80%, rgba(255, 255, 255, 0.3), transparent);
                    background-size: 200% 200%;
                    animation: particleFloat 20s ease-in-out infinite;
                    opacity: 0.2;
                    z-index: -1;
                }

                @keyframes gradientShift {
                    0%, 100% { background-position: 0% 50%; }
                    50% { background-position: 100% 50%; }
                }

                @keyframes particleFloat {
                    0%, 100% { transform: translate(0, 0); }
                    33% { transform: translate(30px, -30px); }
                    66% { transform: translate(-20px, 20px); }
                }

                /* ===== HEADER GLASSMORPHISM ===== */
                .header {
                    background: rgba(20, 20, 30, 0.6);
                    backdrop-filter: blur(20px);
                    -webkit-backdrop-filter: blur(20px);
                    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
                    padding: 20px 0;
                    position: sticky;
                    top: 0;
                    z-index: 1000;
                }

                .header-content {
                    max-width: 1400px;
                    margin: 0 auto;
                    padding: 0 10px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    flex-wrap: wrap;
                    gap: 20px;
                }

                .header-date {
                    color: rgba(255, 255, 255, 0.9);
                    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                }

                .header-datetime {
                    font-size: 1.6em;  /* ‚Üê Increased from 0.9em - makes time BIGGER */
                    font-weight: 750;  /* ‚Üê Increased from 600 - makes time BOLDER */
                    margin-bottom: 5px;
                    letter-spacing: 2px;
                }

                .timezone-info {
                    
                    padding: 4px 12px;
                    border-radius: 20px;
                    font-size: 1em;  /* Smaller for date */
                    
                }


                .header h2 {
                    font-size: 1.8em;
                    color: rgba(255, 255, 255, 0.95);
                    text-shadow: 0 2px 20px rgba(100, 100, 255, 0.4);
                    letter-spacing: 2px;
                    flex: 1;
                    text-align: center;
                    animation: glow 3s ease-in-out infinite;
                }

                @keyframes glow {
                    0%, 100% { text-shadow: 0 2px 20px rgba(100, 100, 255, 0.4); }
                    50% { text-shadow: 0 2px 30px rgba(100, 150, 255, 0.6), 0 0 40px rgba(50, 80, 200, 0.5); }
                }

                .header-user-menu {
                    display: flex;
                    gap: 15px;
                    align-items: center;
                    color: rgba(255, 255, 255, 0.9);
                }

                .user-greeting {
                    font-weight: 600;
                    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
                }

                .user-link {
                    color: rgba(255, 255, 255, 0.9);
                    text-decoration: none;
                    padding: 8px 16px;
                    border-radius: 25px;
                    background: rgba(255, 255, 255, 0.05);
                    backdrop-filter: blur(10px);
                    border: 1px solid rgba(255, 255, 255, 0.15);
                    transition: all 0.3s ease;
                    font-size: 0.9em;
                }

                .user-link:hover {
                    background: rgba(255, 255, 255, 0.12);
                    transform: translateY(-2px);
                    box-shadow: 0 5px 15px rgba(100, 100, 255, 0.3);
                    border-color: rgba(255, 255, 255, 0.25);
                }

                /* ===== CONTAINER ===== */
                .container {
                    max-width: 1500px;
                    margin: 0 auto;
                    padding: 10px 10px;
                }

                /* ===== GLASSMORPHISM STAT CARDS ===== */
                .master-stats {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
                    gap: 20px;
                    margin-bottom: 10px;
                }

                .stat-card {
                    background: rgba(30, 30, 45, 0.5);
                    backdrop-filter: blur(20px);
                    -webkit-backdrop-filter: blur(20px);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    border-radius: 25px;
                    padding: 10px;
                    text-align: center;
                    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
                    transition: all 0.4s ease;
                    position: relative;
                    overflow: hidden;
                }

                /* Animated border glow */
                .stat-card::before {
                    content: '';
                    position: absolute;
                    top: -2px;
                    left: -2px;
                    right: -2px;
                    bottom: -2px;
                    background: linear-gradient(45deg, transparent, rgba(100, 100, 255, 0.3), transparent);
                    border-radius: 25px;
                    opacity: 0;
                    transition: opacity 0.4s ease;
                    z-index: -1;
                }

                .stat-card:hover::before {
                    opacity: 1;
                    animation: borderRotate 2s linear infinite;
                }

                @keyframes borderRotate {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(360deg); }
                }

                .stat-card:hover {
                    transform: translateY(-10px) scale(1.02);
                    box-shadow: 0 15px 45px rgba(0, 0, 0, 0.5);
                    background: rgba(40, 40, 60, 0.6);
                    border-color: rgba(255, 255, 255, 0.2);
                }

                .stat-value {
                    font-weight: 700;
                    margin-bottom: -10px;
                    text-shadow: 0 2px 20px rgba(0, 0, 0, 0.4);
                    transition: all 0.3s ease;
                }

                .stat-card:hover .stat-value {
                    transform: scale(1);
                }

                /* Individual card colors - adjusted for dark theme */
                .stat-card.total-power .stat-value {
                    color: #00ff88;
                    font-size : 4.1em;
                    text-shadow: 0 0 20px rgba(0, 255, 136, 0.7);
                }

                .stat-card.active-plants .stat-value {
                    font-size : 3em;
                    color: #4ecdc4;
                    text-shadow: 0 0 20px rgba(78, 205, 196, 0.7);
                }

                .stat-card.online-units .stat-value {
                    font-size : 3em;
                    color: #4ecdc4;
                    text-shadow: 0 0 20px rgba(78, 205, 196, 0.7);
                }
                
                .stat-card.running-units .stat-value {
                    font-size : 3em;
                    color: #4ecdc4;
                    text-shadow: 0 0 20px rgba(78, 205, 196, 0.7);
                }

                .stat-card.standby-units .stat-value {
                    font-size : 3em;
                    color: #ffe66d;
                    text-shadow: 0 0 20px rgba(255, 230, 109, 0.7);
                }

                .stat-card.total-units .stat-value {
                    font-size : 3em;
                    color: #a8dadc;
                    text-shadow: 0 0 20px rgba(168, 218, 220, 0.7);
                }

                .stat-label {
                    color: rgba(255, 255, 255, 0.95);
                    font-size: 1.2em;
                    font-weight: 600;
                    margin-bottom: 5px;
                    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
                }

                .stat-sublabel {
                    color: rgba(255, 255, 255, 0.7);
                    font-size: 1em;
                    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.4);
                }
                .unit {
                    font-size: 0.5em;           /* Small relative to the 4.1em parent */
                    vertical-align:align;      
                    margin-left: 5px;           
                    opacity: 0.9;               
                    color: #ffffffff;
                    font-weight: 600;           /* Lighter weight than the bold number */
                }

                          /* ===== PLANT SELECTION GLASSMORPHISM ===== */

                /* Enhanced Plant Button Layout */

                .plant-selection h2 {
                    color: #feffffff;  /* Green color - matches your total power */
                    text-align: left;
                    margin-bottom: 20px;
                    font-size: 1.3em;
                    
                }
                .plant-btn {
                    background: rgba(0, 0, 0, 0.4);
                    backdrop-filter: blur(15px);
                    -webkit-backdrop-filter: blur(15px);
                    border: 2px solid rgba(255, 255, 255, 0.1);
                    border-radius: 20px;
                    padding: px;
                    cursor: pointer;
                    transition: all 0.4s ease;
                    text-align: center;
                    position: relative;
                    overflow: hidden;
                }

                .plant-btn:hover {
                    transform: translateY(-8px) scale(1.03);
                    background: rgba(50, 50, 70, 0.5);
                    border-color: rgba(255, 255, 255, 0.25);
                    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
                }

                .plant-btn-title {
                    font-size: 1.3em;
                    font-weight: 700;
                    color: rgba(255, 255, 255, 0.95);
                    margin-bottom: 8px;
                    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
                }

                /* Unit Status Grid */
                .unit-status-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(50px, 60px));
                    align-items : center;
                    gap: 8px;
                    margin: 5px 0;
                    padding: 5px;
                    background: rgba(0, 0, 0, 0.2);
                    border-radius: 12px;
                    justify-content : center;
                }

                .unit-status-item {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    gap: 4px;
                    padding: 2px;
                    background: rgba(255, 255, 255, 0.05);
                    border-radius: 8px;
                    transition: all 0.3s ease;
                }

                .unit-status-item:hover {
                    background: rgba(255, 255, 255, 0.1);
                    transform: scale(1.05);
                }

                .unit-label {
                    font-size: 0.75em;
                    font-weight: 600;
                    color: rgba(255, 255, 255, 0.8);
                    margin-bottom: 2px;
                }

                .unit-status-dot {
                    width: 8px;
                    height: 8px;
                    border-radius: 40%;
                    display: inline-block;
                    position: relative;
                    box-shadow: 0 0 8px currentColor;
                }

                .unit-status-dot::before {
                    content: '';
                    position: absolute;
                    top: -3px;
                    left: -3px;
                    right: -3px;
                    bottom: -3px;
                    border-radius: 100%;
                    opacity: 0.5;
                }

                /* Status Colors */
                .unit-status-dot.running {
                    background: #00ff88;
                    box-shadow: 0 0 12px rgba(0, 255, 136, 0.7);
                    animation: pulse-running 2s ease-in-out infinite;
                }

                .unit-status-dot.running::before {
                    background: #00ff88;
                    animation: ripple 2s ease-in-out infinite;
                }

                .unit-status-dot.standby {
                    background: #ffe66d;
                    box-shadow: 0 0 12px rgba(255, 230, 109, 0.8);
                    animation: pulse-standby 3s ease-in-out infinite;
                }

                .unit-status-dot.standby::before {
                    background: #ffe66d;
                    animation: ripple 3s ease-in-out infinite;
                }

                .unit-status-dot.offline {
                    background: #ff6b6b;
                    box-shadow: 0 0 8px rgba(255, 107, 107, 0.6);
                    opacity: 0.8;
                }

                .unit-status-text {
                    font-size: 0.7em;
                    color: rgba(255, 255, 255, 0.7);
                    text-transform: uppercase;
                    letter-spacing: 0.5px;
                    margin-top: 2px;
                }

                /* Summary Info */
                .plant-summary {
                    display: flex;
                    justify-content: space-around;
                    gap: 10px;
                    margin: 10px 0;
                    padding: 8px;
                    background: rgba(0, 0, 0, 0.2);
                    border-radius: 10px;
                    font-size: 0.85em;
                }

                .summary-item {
                    display: flex;
                    align-items: center;
                    gap: 5px;
                    color: rgba(255, 255, 255, 0.9);
                }

                .summary-dot {
                    width: 8px;
                    height: 8px;
                    border-radius: 50%;
                }

                .summary-dot.running { background: #00ff88; }
                .summary-dot.standby { background: #ffe66d; }
                .summary-dot.offline { background: #ff6b6b; }

                .plant-btn-power {
                    font-size: 1.6em;
                    font-weight: 700;
                    color: #5ace5e;
                    margin-top: 10px;
                    text-shadow: 0 0 10px rgba(90, 206, 94, 0.6);
                }

                /* Animations */
                @keyframes pulse-running {
                    0%, 100% { transform: scale(1); opacity: 1; }
                    50% { transform: scale(1.15); opacity: 0.8; }
                }

                @keyframes pulse-standby {
                    0%, 100% { transform: scale(1); opacity: 1; }
                    50% { transform: scale(1.1); opacity: 0.7; }
                }

                @keyframes ripple {
                    0% { transform: scale(1); opacity: 0.5; }
                    100% { transform: scale(2.5); opacity: 0; }
                }

                /* Responsive */
                @media (max-width: 768px) {
                    .unit-status-grid {
                        grid-template-columns: repeat(auto-fit, minmax(50px, 1fr));
                        gap: 6px;
                    }
                    
                    .unit-status-item {
                        padding: 6px;
                    }
                }

                /* ===== RESPONSIVE ===== */
                @media (max-width: 768px) {
                    .header-content {
                        flex-direction: column;
                        text-align: center;
                    }

                    .header h2 {
                        font-size: 1.3em;
                    }

                    .master-stats {
                        grid-template-columns: 1fr;
                    }

                    .plant-buttons {
                        grid-template-columns: 1fr;
                    }

                    .stat-value {
                        font-size: 2.5em;
                    }
                }

                /* ===== LOADING SHIMMER EFFECT ===== */
                @keyframes shimmer {
                    0% { background-position: -1000px 0; }
                    100% { background-position: 1000px 0; }
                }

                .loading-shimmer {
                    background: linear-gradient(90deg, 
                        rgba(255, 255, 255, 0.05) 0%, 
                        rgba(255, 255, 255, 0.15) 50%, 
                        rgba(255, 255, 255, 0.05) 100%);
                    background-size: 1000px 100%;
                    animation: shimmer 2s infinite;
                }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">

            <div class="header-logo">
                <img src="{{ url_for('static', filename='images/logo.svg') }}" alt="WKV Logo">
            </div>

            <div class="header-date">
                <div class="header-datetime" id="currentDateTime">14:30:45</div>
                <div class="timezone-label">GMT+5:30 (Sri Lanka)</div>
                <div class="timezone-info" id="currentDate">2025-11-16</div>
            </div>

            <h2> WKV Online Monitoring System </h2>

            <div class="header-user-menu">
                {% if session.get('user_id') %}
                    <span class="user-greeting">Hi, {{ session.get('username') }}</span>
                    <a href="{{ url_for('auth.profile') }}" class="user-link">Profile</a>
                    <a href="{{ url_for('auth.logout') }}" class="user-link">Logout</a>
                {% else %}
                    <a href="{{ url_for('auth.login') }}" class="user-link">Login</a>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Master Statistics - REORDERED -->
        <div class="master-stats">

            <!-- 1. Total Power -->
            <div class="stat-card total-power">
                <div class="stat-value total-power" id="totalPower">{{ "%.2f"|format(total_power / 1000) }} <span class="unit">MW</span></div>
                <div class="stat-label">Total Power</div>
                <!-- <div class="stat-sublabel">MW</div> -->
            </div>
            
            <!-- 2. Active Plants -->
            <div class="stat-card active-plants">
                <div class="stat-value active-plants" id="activePlants">{{ active_plants }}</div>
                <div class="stat-label">Online Plants</div>
                <div class="stat-sublabel">Out of 13</div>
            </div>

            <!-- 3. online Units -->
            <div class="stat-card online-units">
                <div class="stat-value online-units" id="onlineUnits">{{ total_online_units }}</div>
                <div class="stat-label">Online Units</div>
                <div class="stat-sublabel">Out of 26</div>
            </div>

            <!-- 3. Running Units -->
            <div class="stat-card running-units">
                <div class="stat-value" id="runningUnits">{{ total_running_units }}</div>
                <div class="stat-label">Running Units</div>
                <div class="stat-sublabel">Generating Power</div>
            </div>

            <!-- 4. Standby Units -->
            <div class="stat-card standby-units">
                <div class="stat-value" id="standbyUnits">{{ total_standby_units }}</div>
                <div class="stat-label">Standby Units</div>
                <div class="stat-sublabel">Ready to Start</div>
            </div>

            <!-- 5. Total Units -->
           <!--- <div class="stat-card total-units">
                <div class="stat-value total-units" id="totalUnitsDisplay">{{ total_units }}</div>
                <div class="stat-label">Total Units</div>
                <div class="stat-sublabel">All Plants</div>
            </div> -->
        </div>

        <!-- Plant Selection -->
        <div class="plant-selection">
            <h2>üè≠ Select Plant to Monitor</h2>
            <div class="plant-buttons" id="plantButtons" style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px;">
                {% for plant_id, data in plant_data.items() %}
                <div class="plant-btn" onclick="window.location.href='/plant/{{ plant_id }}';">
                    <div class="plant-btn-title">{{ plant_names[plant_id] }}</div>
                    
                    <div class="plant-btn-power">{{ "%.1f"|format(data.total_power) }} kW</div>

                    <!-- Individual Unit Status Grid -->
                    <div class="unit-status-grid">
                        {% for unit in data.units %}
                        <div class="unit-status-item">
                            <div class="unit-label">U{{ unit.unit_id }}</div>
                            <span class="unit-status-dot {{ unit.status }}"></span>
                            <div class="unit-status-text">
                                {% if unit.status in ['online', 'running'] %}Running
                                {% elif unit.status == 'standby' %}standby
                                {% else %}offline{% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    
                    <!-- Summary Info -->
                   <!-- <div class="plant-summary">
                        <div class="summary-item">
                            <span class="summary-dot running"></span>
                            R: {{ data.running_units }}
                        </div>
                        <div class="summary-item">
                            <span class="summary-dot standby"></span>
                            S: {{ data.standby_units }}
                        </div>
                        <div class="summary-item">
                            <span class="summary-dot offline"></span>
                            O: {{ data.offline_units }}
                        </div> 
                    </div> -->
                    
                
                </div>
                {% endfor %}
            </div>
        </div>

    <!-- LOAD EXTERNAL JAVASCRIPT FILE -->
    <script src="{{ url_for('static', filename='js/master_dashboard02.js') }}"></script>

</body>
</html>